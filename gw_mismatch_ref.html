

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reference on kuibit.gw_mismatch &#8212; kuibit 1.3.3 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference on kuibit.grid_data" href="grid_data_ref.html" />
    <link rel="prev" title="Reference on kuibit.gw_utils" href="gw_utils_ref.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="grid_data_ref.html" title="Reference on kuibit.grid_data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gw_utils_ref.html" title="Reference on kuibit.gw_utils"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference on kuibit.gw_mismatch</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-kuibit.gw_mismatch">
<span id="reference-on-kuibit-gw-mismatch"></span><h1>Reference on kuibit.gw_mismatch<a class="headerlink" href="#module-kuibit.gw_mismatch" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-kuibit.gw_mismatch" title="kuibit.gw_mismatch"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gw_mismatch</span></code></a> module functions to compute the mismatch between
two waves using a simple grid search for phase and time shifts. Since no
polarization shifts are performed, this is only relevant to the gravitational
wave 2,2 mode.</p>
<p>The two main interfaces are <a class="reference internal" href="#kuibit.gw_mismatch.network_mismatch_from_psi4" title="kuibit.gw_mismatch.network_mismatch_from_psi4"><code class="xref py py-func docutils literal notranslate"><span class="pre">network_mismatch_from_psi4()</span></code></a> (when
computing the network mismatch starting from psi4 and the sky localization) and
<a class="reference internal" href="#kuibit.gw_mismatch.mismatch_from_strains" title="kuibit.gw_mismatch.mismatch_from_strains"><code class="xref py py-func docutils literal notranslate"><span class="pre">mismatch_from_strains()</span></code></a> (when computing the mismatch from the
strains).</p>
<blockquote>
<div><p>..warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Make</span> <span class="n">sure</span> <span class="n">to</span> <span class="n">understand</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">going</span> <span class="n">on</span> <span class="k">if</span> <span class="n">you</span> <span class="n">are</span> <span class="n">using</span> <span class="n">this</span> <span class="n">module</span><span class="o">.</span>
<span class="n">You</span> <span class="n">should</span> <span class="n">read</span> <span class="n">the</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">comments</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">code</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py function">
<dt id="kuibit.gw_mismatch.mismatch_from_strains">
<code class="sig-prename descclassname"><span class="pre">kuibit.gw_mismatch.</span></code><code class="sig-name descname"><span class="pre">mismatch_from_strains</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noises</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_polarization_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/gw_mismatch.html#mismatch_from_strains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.gw_mismatch.mismatch_from_strains" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the network-mismatch between <code class="docutils literal notranslate"><span class="pre">h1</span></code> and <code class="docutils literal notranslate"><span class="pre">h2</span></code> by maximizing the
overlap over time and polarization shifts.</p>
<p>Network here means that the inner product is computed for N detectors, as
provided by the lists antenna_patterns and noises. Noises and antenna
patterns have to be properly ordered: <code class="docutils literal notranslate"><span class="pre">noises[i]</span></code> has to correspond to
<code class="docutils literal notranslate"><span class="pre">antenna_pattern[i]</span></code>.</p>
<p>See <a class="reference internal" href="gw_mismatch.html#overlap-and-mismatch"><span class="std std-ref">Overlap and mismatch</span></a> for formulas and details.</p>
<p>The mismatch is computed by maximizing over time and polarization shifts.
Polarization shifts and are around the 2pi, time shifts are specified by
time_shift_start and time_shift_end. If num_time_shifts is 1, then no time
shift is performed. For times, we make sure that we always have to zero
timeshift. All the transformations are done in h2.</p>
<p>This computation is a maximisation, which is very expensive. So, we have a
very fast core function called _mismatch_core_numerical to do all the hard
work. This function is compiled to native code by numba, resulting to
enormous speed-up.There is an overhead in calling numba. Hence, by default
we do not always use numba. We use it only when the number
num_polarization_shifts * num_time_shifts is greater than 500*500. You can
force using numba passing the keyword argument force_numba=True.</p>
<p>We do not perform phase shifts here, so this function makes sense only
for the (2,2) mode.</p>
<p>h1 and h2 have to be already pre-processed for Fourier transform, so you
should window them and zero pad as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h1</strong> (<a class="reference internal" href="timeseries_ref.html#kuibit.timeseries.TimeSeries" title="kuibit.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – First strain.</p></li>
<li><p><strong>h2</strong> (<a class="reference internal" href="timeseries_ref.html#kuibit.timeseries.TimeSeries" title="kuibit.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – Second strain (the one that will be modified).</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower limit of the integration.</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Higher limit of the integration.</p></li>
<li><p><strong>noises</strong> (list of <a class="reference internal" href="frequencyseries_ref.html#kuibit.frequencyseries.FrequencySeries" title="kuibit.frequencyseries.FrequencySeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrequencySeries</span></code></a>, or None) – Power spectral density of the noise for all the detectors.
If None, a uniform noise is applied.</p></li>
<li><p><strong>antenna_patterns</strong> (<em>list of tuples</em><em>, or </em><em>None</em>) – Fc, Fp for all the detectors. It has to be ordered
in the same way as noises. If None, a uniform antenna
pattern is applied.</p></li>
<li><p><strong>num_polarization_shifts</strong> (<em>int</em>) – How many points to divide the range
(0, 2 pi) in the polarization shift.</p></li>
<li><p><strong>num_time_shifts</strong> (<em>int</em>) – How many points to divide the range
(time_shift_start, time_shift_end) in the time shift.</p></li>
<li><p><strong>time_shift_start</strong> (<em>float</em>) – Minimum time shift applied. Search will be done
linearly up to time_shift_end.</p></li>
<li><p><strong>time_shift_end</strong> (<em>float</em>) – Largest value of time shift applied.</p></li>
<li><p><strong>force_numba</strong> (<em>bool</em>) – Use numba irrespectively of the size of the input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="kuibit.gw_mismatch.network_mismatch">
<code class="sig-prename descclassname"><span class="pre">kuibit.gw_mismatch.</span></code><code class="sig-name descname"><span class="pre">network_mismatch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noises</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_polarization_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/gw_mismatch.html#network_mismatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.gw_mismatch.network_mismatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute network mismatch between strains h1 and h2.</p>
<p>This is a wrapper around <code class="xref py py-meth docutils literal notranslate"><span class="pre">mismatch_from_strains()</span></code> (read the
docstring for more information) that prepares the correct antenna patterns
from the sky localization of the event. Moreover, it makes sure that noises
(that has to be a gw_utils.Detectors object, or None) is correctly ordered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h1</strong> (<a class="reference internal" href="timeseries_ref.html#kuibit.timeseries.TimeSeries" title="kuibit.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – First strain.</p></li>
<li><p><strong>h2</strong> (<a class="reference internal" href="timeseries_ref.html#kuibit.timeseries.TimeSeries" title="kuibit.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – Second strain (the one that will be modified).</p></li>
<li><p><strong>right_ascension</strong> (<em>float</em>) – Right ascension of the source in the sky.</p></li>
<li><p><strong>declination</strong> (<em>float</em>) – Declination of the source in the sky.</p></li>
<li><p><strong>time_utc</strong> (<em>float</em>) – Time UTC of the event.</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower limit of the integration.</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Higher limit of the integration.</p></li>
<li><p><strong>noises</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code>, or None) – Power spectral density of the noise for all the detectors.</p></li>
<li><p><strong>num_polarization_shifts</strong> (<em>int</em>) – How many points to divide the range
(0, 2 pi) in the polarization shift.</p></li>
<li><p><strong>num_time_shifts</strong> (<em>int</em>) – How many points to divide the range
(time_shift_start, time_shift_end) in the
time shift.</p></li>
<li><p><strong>time_shift_start</strong> (<em>float</em>) – Minimum time shift applied. Search will be done
linearly up to time_shift_end.</p></li>
<li><p><strong>time_shift_end</strong> (<em>float</em>) – Largest value of time shift applied.</p></li>
<li><p><strong>force_numba</strong> (<em>bool</em>) – Use numba irrespectively of the size of the input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="kuibit.gw_mismatch.network_mismatch_from_psi4">
<code class="sig-prename descclassname"><span class="pre">kuibit.gw_mismatch.</span></code><code class="sig-name descname"><span class="pre">network_mismatch_from_psi4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcut1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcut2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_at_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_ends</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_scale1_msun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_scale2_msun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noises</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_zero_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_polarization_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_to_keep_after_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_removed_beginning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/gw_mismatch.html#network_mismatch_from_psi4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.gw_mismatch.network_mismatch_from_psi4" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mismatch between strains from psi1 and psi2.</p>
<p>This function is complex, read <a class="reference internal" href="gw_mismatch.html#overlap-and-mismatch"><span class="std std-ref">Overlap and mismatch</span></a> for
formulas and details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi1</strong> (<a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a>) – <span class="math notranslate nohighlight">\(\Psi_4\)</span> for the first wave.</p></li>
<li><p><strong>psi2</strong> (<a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a>) – <span class="math notranslate nohighlight">\(\Psi_4\)</span> for the second wave (the one that will be
modified).</p></li>
<li><p><strong>right_ascension</strong> (<em>float</em>) – Right ascension of the source in the sky.</p></li>
<li><p><strong>declination</strong> (<em>float</em>) – Declination of the source in the sky.</p></li>
<li><p><strong>mass_scale1_msun</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, the signal h1 is converted from
computational units to physical units assuming that
<code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">=</span> <span class="pre">mass_scale1_msun</span></code>.</p></li>
<li><p><strong>mass_scale2_msun</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, the signal h2 is converted from
computational units to physical units assuming that
M = mass_scale2_msun.</p></li>
<li><p><strong>time_utc</strong> (<em>float</em>) – Time UTC of the event.</p></li>
<li><p><strong>pcut1</strong> (<em>float</em>) – Period associated with the threshold frequency
<code class="docutils literal notranslate"><span class="pre">omega_0</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">pcut</span></code> for the fixed frequency
integration of <span class="math notranslate nohighlight">\(\Psi_4\)</span></p></li>
<li><p><strong>pcut2</strong> (<em>float</em>) – Period associated with the threshold frequency
<code class="docutils literal notranslate"><span class="pre">omega_0</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">pcut</span></code> for the fixed frequency
integration of <span class="math notranslate nohighlight">\(\Psi_4\)</span></p></li>
<li><p><strong>window_function</strong> (<em>callable</em><em>, </em><em>str</em><em>, or </em><em>None</em>) – If not None, apply window_function to the
series before computing the strain.</p></li>
<li><p><strong>trim_ends</strong> (<em>bool</em>) – If True, a portion of the resulting strain is removed
at both the initial and final times. The amount
removed is equal to pcut.</p></li>
<li><p><strong>align_at_peak</strong> (<em>bool</em>) – Time-shifts the strain so that they have both the
maximum amplitude at <code class="docutils literal notranslate"><span class="pre">t=0</span></code>.</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower limit of the integration.</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Higher limit of the integration.</p></li>
<li><p><strong>noises</strong> (<a class="reference internal" href="gw_utils_ref.html#kuibit.gw_utils.Detectors" title="kuibit.gw_utils.Detectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detectors</span></code></a>, or None) – Power spectral density of the noise for all the
detectors. If None, a uniform noise is applied.</p></li>
<li><p><strong>num_zero_pad</strong> (<em>int</em>) – How many points do the timeseries have to have
before Fourier transforms are taken? This is not
the number of zeros added (at the end) of the timeseries,
this is the total number. If the series already have that
length, no zeros will be added.</p></li>
<li><p><strong>num_polarization_shifts</strong> (<em>int</em>) – How many points to divide the range
(0, 2 pi) in the polarization shift.</p></li>
<li><p><strong>num_time_shifts</strong> (<em>int</em>) – How many points to divide the range
(time_shift_start, time_shift_end) in the time shift.</p></li>
<li><p><strong>time_shift_start</strong> (<em>float</em>) – Minimum time shift applied. Search will be
done linearly up to time_shift_end.</p></li>
<li><p><strong>time_shift_end</strong> (<em>float</em>) – Largest value of time shift applied.</p></li>
<li><p><strong>time_removed_beginning</strong> (<em>float</em><em> or </em><em>None</em>) – Remove this amount from the beginning
of the strain signals before computing the
mismatch. If None, nothing is removed.</p></li>
<li><p><strong>time_to_keep_after_max</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, remove all the signal that
comes after t_max + time_to_keep_after_max,
where t_max is the time at which the signal peaks.</p></li>
<li><p><strong>force_numba</strong> (<em>bool</em>) – Use numba irrespectively of the size of the input.</p></li>
<li><p><strong>args</strong> (<em>anything</em>) – All the other arguments are passed to the window
function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="kuibit.gw_mismatch.one_detector_mismatch_from_psi4">
<code class="sig-prename descclassname"><span class="pre">kuibit.gw_mismatch.</span></code><code class="sig-name descname"><span class="pre">one_detector_mismatch_from_psi4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcut1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcut2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_at_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_ends</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_scale1_msun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_scale2_msun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_zero_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_polarization_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_to_keep_after_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_removed_beginning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/gw_mismatch.html#one_detector_mismatch_from_psi4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.gw_mismatch.one_detector_mismatch_from_psi4" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mismatch between strains from psi1 and psi2.</p>
<p>This function is complex, read <a class="reference internal" href="gw_mismatch.html#overlap-and-mismatch"><span class="std std-ref">Overlap and mismatch</span></a> for
formulas and details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi1</strong> (<a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a>) – <span class="math notranslate nohighlight">\(\Psi_4\)</span> for the first wave.</p></li>
<li><p><strong>psi2</strong> (<a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a>) – <span class="math notranslate nohighlight">\(\Psi_4\)</span> for the second wave (the one that will be
modified).</p></li>
<li><p><strong>right_ascension</strong> (<em>float</em>) – Right ascension of the source in the sky.</p></li>
<li><p><strong>declination</strong> (<em>float</em>) – Declination of the source in the sky.</p></li>
<li><p><strong>mass_scale1_msun</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, the signal h1 is converted from
computational units to physical units assuming that
M = mass_scale1_msun.</p></li>
<li><p><strong>mass_scale2_msun</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, the signal h2 is converted from
computational units to physical units assuming that
M = mass_scale2_msun.</p></li>
<li><p><strong>time_utc</strong> (<em>float</em>) – Time UTC of the event.</p></li>
<li><p><strong>pcut1</strong> (<em>float</em>) – Period associated with the threshold frequency
<code class="docutils literal notranslate"><span class="pre">omega_0</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">pcut</span></code> for the fixed frequency
integration of <span class="math notranslate nohighlight">\(\Psi_4\)</span></p></li>
<li><p><strong>pcut2</strong> (<em>float</em>) – Period associated with the threshold frequency
<code class="docutils literal notranslate"><span class="pre">omega_0</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">pcut</span></code> for the fixed frequency
integration of <span class="math notranslate nohighlight">\(\Psi_4\)</span></p></li>
<li><p><strong>window_function</strong> (<em>callable</em><em>, </em><em>str</em><em>, or </em><em>None</em>) – If not None, apply window_function to the
series before computing the strain.</p></li>
<li><p><strong>trim_ends</strong> (<em>bool</em>) – If True, a portion of the resulting strain is removed
at both the initial and final times. The amount removed
is equal to pcut.</p></li>
<li><p><strong>align_at_peak</strong> (<em>bool</em>) – Time-shifts the strain so that they have both the
maximum amplitude at <code class="docutils literal notranslate"><span class="pre">t=0</span></code>.</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – Lower limit of the integration.</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – Higher limit of the integration.</p></li>
<li><p><strong>noises</strong> (<a class="reference internal" href="gw_utils_ref.html#kuibit.gw_utils.Detectors" title="kuibit.gw_utils.Detectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detectors</span></code></a>, or None) – Power spectral density of the noise for all the
detectors. If None, a uniform noise is applied.</p></li>
<li><p><strong>num_zero_pad</strong> (<em>int</em>) – How many points do the timeseries have to have
before Fourier transforms are taken? This is not the
number of zeros added (at the end) of the timeseries,
this is the total number. If the series already have
that length, no zeros will be added.</p></li>
<li><p><strong>num_polarization_shifts</strong> (<em>int</em>) – How many points to divide the range
(0, 2 pi) in the polarization shift.</p></li>
<li><p><strong>num_time_shifts</strong> (<em>int</em>) – How many points to divide the range
(time_shift_start, time_shift_end) in the time shift.</p></li>
<li><p><strong>time_shift_start</strong> (<em>float</em>) – Minimum time shift applied. Search will be
done linearly up to time_shift_end.</p></li>
<li><p><strong>time_shift_end</strong> (<em>float</em>) – Largest value of time shift applied.</p></li>
<li><p><strong>time_removed_beginning</strong> (<em>float</em><em> or </em><em>None</em>) – Remove this amount from the beginning
of the strain signals before computing
the mismatch. If None, nothing is removed.</p></li>
<li><p><strong>time_to_keep_after_max</strong> (<em>float</em><em> or </em><em>None</em>) – If not None, remove all the signal that
comes after t_max + time_to_keep_after_max,
where t_max is the time at which the signal
peaks.</p></li>
<li><p><strong>force_numba</strong> (<em>bool</em>) – Use numba irrespectively of the size of the input.</p></li>
<li><p><strong>args</strong> (<em>anything</em>) – All the other arguments are passed to the window
function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="gw_utils_ref.html"
                        title="previous chapter">Reference on kuibit.gw_utils</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="grid_data_ref.html"
                        title="next chapter">Reference on kuibit.grid_data</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="grid_data_ref.html" title="Reference on kuibit.grid_data"
             >next</a> |</li>
        <li class="right" >
          <a href="gw_utils_ref.html" title="Reference on kuibit.gw_utils"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference on kuibit.gw_mismatch</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020-2021, Gabriele Bozzola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  </body>
</html>