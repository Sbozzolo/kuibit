

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>plot_1d_slice.py &#8212; kuibit 1.3.5 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="plot_1d_vars.py" href="plot_1d_vars.html" />
    <link rel="prev" title="picklify.py" href="picklify.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_1d_vars.html" title="plot_1d_vars.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="picklify.html" title="picklify.py"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kuibit 1.3.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">plot_1d_slice.py</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="plot-1d-slice-py">
<h1>plot_1d_slice.py<a class="headerlink" href="#plot-1d-slice-py" title="Permalink to this headline">Â¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">plot_1d_slice</span></code> plots a grid function along one of the coordinate axis. If 1D
is available, then it is used. If not, then 2D data is used (slicing it so that
the other coordinate is set to 0). If 2D data is not available, then 3D is used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># PYTHON_ARGCOMPLETE_OK</span>

<span class="c1"># Copyright (C) 2021-2022 Gabriele Bozzola</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify it under</span>
<span class="c1"># the terms of the GNU General Public License as published by the Free Software</span>
<span class="c1"># Foundation; either version 3 of the License, or (at your option) any later</span>
<span class="c1"># version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="c1"># ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<span class="c1"># FOR A PARTICULAR PURPOSE. See the GNU General Public License for more</span>
<span class="c1"># details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License along with</span>
<span class="c1"># this program; if not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">kuibit</span> <span class="kn">import</span> <span class="n">argparse_helper</span> <span class="k">as</span> <span class="n">kah</span>
<span class="kn">from</span> <span class="nn">kuibit.simdir</span> <span class="kn">import</span> <span class="n">SimDir</span>
<span class="kn">from</span> <span class="nn">kuibit.visualize_matplotlib</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">add_text_to_corner</span><span class="p">,</span>
    <span class="n">save_from_dir_filename_ext</span><span class="p">,</span>
    <span class="n">set_axis_limits_from_args</span><span class="p">,</span>
    <span class="n">setup_matplotlib</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">setup_matplotlib</span><span class="p">()</span>

    <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">{kah.get_program_name()} plots a grid function on one of the coordinate axis. 1D</span>
<span class="s2">data is used if available, otherwise higher dimensional data is used.&quot;&quot;&quot;</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">kah</span><span class="o">.</span><span class="n">init_argparse</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="n">kah</span><span class="o">.</span><span class="n">add_figure_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">add_limits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--variable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Variable to plot.&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--iteration&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Iteration to plot. If -1, the latest.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--multilinear-interpolate&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether to interpolate to smooth data with multilinear&quot;</span>
        <span class="s2">&quot; interpolation before plotting.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--resolution&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Resolution to use for the plot.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
        <span class="s2">&quot;--logscale&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use a logarithmic y scale.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--absolute&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether to take the absolute value.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--axis&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Axis to plot (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">kah</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>

    <span class="n">iteration</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">axis</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">figname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">_sliced&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">figname</span>

    <span class="k">with</span> <span class="n">SimDir</span><span class="p">(</span>
        <span class="n">args</span><span class="o">.</span><span class="n">datadir</span><span class="p">,</span>
        <span class="n">ignore_symlinks</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ignore_symlinks</span><span class="p">,</span>
        <span class="n">pickle_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">pickle_file</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Prepared SimDir&quot;</span><span class="p">)</span>

        <span class="c1"># Okay, we need to understand where to read the data from</span>

        <span class="c1"># Do we have 1D data?</span>
        <span class="k">if</span> <span class="n">var_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
            <span class="c1"># We do not have 1D data, so let&#39;s check if we have 2D data</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> not available in </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Depending on what axis the user requested, we need to look at</span>
            <span class="c1"># different data. The variable containing_axis maps the axis</span>
            <span class="c1"># to 2D data that might contain it.</span>
            <span class="n">containing_axis</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span><span class="p">),</span>
                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="s2">&quot;yz&quot;</span><span class="p">),</span>
                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;xz&quot;</span><span class="p">,</span> <span class="s2">&quot;yz&quot;</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="c1"># Now we loop over the two possible containing axis finding where</span>
            <span class="c1"># the variable is available</span>
            <span class="n">var_in_2D</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">var_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">containing_axis</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
            <span class="p">]</span>

            <span class="c1"># Do we any the data among the 2D data?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">var_in_2D</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> not available in 2D data&quot;</span><span class="p">)</span>

                <span class="c1"># We don&#39;t have the data in the 2D files, so we should check 3D</span>
                <span class="c1"># data</span>
                <span class="k">if</span> <span class="n">var_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="o">.</span><span class="n">xyz</span><span class="p">:</span>
                    <span class="c1"># We don&#39;t have the data in the 3D files either, hence we</span>
                    <span class="c1"># don&#39;t have the data at all.</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> is not available in 1D, 2D, and 3D data&quot;</span>
                    <span class="p">)</span>

                <span class="c1"># We have the data in the 3D files</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using 3D data&quot;</span><span class="p">)</span>

                <span class="c1"># Let&#39;s read it</span>
                <span class="n">var_3D</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">iteration</span> <span class="o">=</span> <span class="n">var_3D</span><span class="o">.</span><span class="n">available_iterations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">time</span> <span class="o">=</span> <span class="n">var_3D</span><span class="o">.</span><span class="n">time_at_iteration</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (time = </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

                <span class="c1"># Now we have to slice it. The variable cuts tells me how to.</span>
                <span class="c1"># We keep one dimension, and set 0, 0 to the others.</span>
                <span class="n">cuts</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">var_3D</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">sliced</span><span class="p">(</span><span class="n">cuts</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># var_name available in 2D data</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using 2D data&quot;</span><span class="p">)</span>

                <span class="c1"># var_in_2D contains two elements. These can be both True, or</span>
                <span class="c1"># only one of the two (in that case, the other must be False).</span>
                <span class="c1"># We need to pick one of the Trues to know what 2D data to read.</span>

                <span class="c1"># var_in_2D.index(True) returns the index of the first True in</span>
                <span class="c1"># the iterable.</span>
                <span class="n">which_axes</span> <span class="o">=</span> <span class="n">containing_axis</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">var_in_2D</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)]</span>

                <span class="n">var_2D</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="p">[</span><span class="n">which_axes</span><span class="p">][</span><span class="n">var_name</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">iteration</span> <span class="o">=</span> <span class="n">var_2D</span><span class="o">.</span><span class="n">available_iterations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">time</span> <span class="o">=</span> <span class="n">var_2D</span><span class="o">.</span><span class="n">time_at_iteration</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (time = </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

                <span class="c1"># Now we have to slice the 2D data. We could be clever, but we</span>
                <span class="c1"># will be clear. cuts is a dictionary that spells out all the</span>
                <span class="c1"># possible options, depending on the containing axes and the</span>
                <span class="c1"># requested one.</span>

                <span class="n">cuts</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]},</span>
                    <span class="s2">&quot;xz&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]},</span>
                    <span class="s2">&quot;yz&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]},</span>
                <span class="p">}</span>

                <span class="c1"># Now we have to slice it</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">var_2D</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">sliced</span><span class="p">(</span><span class="n">cuts</span><span class="p">[</span><span class="n">which_axes</span><span class="p">][</span><span class="n">axis</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># var_name available in 1D data</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using 1D data&quot;</span><span class="p">)</span>

            <span class="c1"># Here we just have to read the data</span>

            <span class="n">var_1D</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">var_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">iteration</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">var_1D</span><span class="o">.</span><span class="n">available_iterations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">time</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">time_at_iteration</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (time = </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">absolute</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="n">variable_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;abs(</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">var</span>
            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">var_name</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resampling to UniformGridData&quot;</span><span class="p">)</span>

        <span class="c1"># We cast to a GridSeries, which is easier to plot.</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_UniformGridData</span><span class="p">(</span>
            <span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">resolution</span><span class="p">],</span>
            <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">xmin</span><span class="p">],</span>
            <span class="n">x1</span><span class="o">=</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">xmax</span><span class="p">],</span>
            <span class="n">resample</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">multilinear_interpolate</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_GridSeries</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logscale</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;log10(</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">log10</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">variable_name</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using label </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting variable </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="n">add_text_to_corner</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$t = </span><span class="si">{</span><span class="n">time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">set_axis_limits_from_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Saving&quot;</span><span class="p">)</span>
        <span class="n">save_from_dir_filename_ext</span><span class="p">(</span>
            <span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
            <span class="n">figname</span><span class="p">,</span>
            <span class="n">args</span><span class="o">.</span><span class="n">fig_extension</span><span class="p">,</span>
            <span class="n">tikz_clean_figure</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">tikz_clean_figure</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;DONE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="picklify.html"
                        title="previous chapter">picklify.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_1d_vars.html"
                        title="next chapter">plot_1d_vars.py</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_1d_vars.html" title="plot_1d_vars.py"
             >next</a> |</li>
        <li class="right" >
          <a href="picklify.html" title="picklify.py"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kuibit 1.3.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">plot_1d_slice.py</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020-2022, Gabriele Bozzola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  </body>
</html>