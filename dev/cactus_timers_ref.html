

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Reference on kuibit.cactus_timers &#8212; kuibit 1.4.0-dev2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference on kuibit.gw_utils" href="gw_utils_ref.html" />
    <link rel="prev" title="Reference on kuibit.cactus_twopunctures" href="cactus_twopunctures_ref.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gw_utils_ref.html" title="Reference on kuibit.gw_utils"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cactus_twopunctures_ref.html" title="Reference on kuibit.cactus_twopunctures"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.4.0-dev2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference on kuibit.cactus_timers</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-kuibit.cactus_timers">
<span id="reference-on-kuibit-cactus-timers"></span><h1>Reference on kuibit.cactus_timers<a class="headerlink" href="#module-kuibit.cactus_timers" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-kuibit.cactus_timers" title="kuibit.cactus_timers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cactus_timers</span></code></a> module provides an interface to Cactus timers.</p>
<p>Currently, the only timers supported are from the XML output by Carpet with the
option <code class="docutils literal notranslate"><span class="pre">output_xml_timer_tree</span> <span class="pre">=</span> <span class="pre">yes</span></code>.</p>
<p>The main class defined in this module is <a class="reference internal" href="#kuibit.cactus_timers.TimersDir" title="kuibit.cactus_timers.TimersDir"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimersDir</span></code></a>. This is a
dictionary-like object that contains most of the information available in the
timers. The keys of this class are the various MPI ranks (ie, process numbers)
found in the output. The value are <a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> objects. These trees
contain the reported call-stack of the simulation with the associated timing
information. Simulation restarts are summed up. Often, it is useful to know how
much a function took on average across different MPI ranks. This can be accessed
with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">TimerDir.average()</span></code> method.</p>
<p>Example of usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming sim is a SimDir</span>
<span class="n">avg_timers</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">timers</span><span class="o">.</span><span class="n">average</span>

<span class="c1"># avg_timers.name contains the name of the top level function, main</span>
<span class="c1"># avg_timers.value contains the time took on average by such function</span>

<span class="c1"># avg_timers.children contains a tuple with all the functions called by main.</span>
<span class="c1"># The type of these functions is Tree, so they have a name and value attribute.</span>

<span class="c1"># By default, the units are second. If you want to normalize to 1 and get the</span>
<span class="c1"># percentual value, you can use</span>
<span class="n">normalized_avg_timers</span> <span class="o">=</span> <span class="n">avg_timers</span> <span class="o">/</span> <span class="n">avg_timers</span><span class="o">.</span><span class="n">tot_value_leaves</span>

<span class="nb">print</span><span class="p">(</span><span class="n">normalized_avg_timers</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>   <span class="c1"># Should be 1</span>

<span class="c1"># Another useful feature is to represent the timer tree with a dictionary or a</span>
<span class="c1"># json file, for postprocessing</span>
<span class="nb">print</span><span class="p">(</span><span class="n">normalized_avg_timers</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="kuibit.cactus_timers.TimersDir">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kuibit.cactus_timers.</span></span><span class="sig-name descname"><span class="pre">TimersDir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/cactus_timers.html#TimersDir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.cactus_timers.TimersDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Timer information read from Carpet.</p>
<p>This is a dictionary-like object that has as keys the process number and as
values the timer information represented as a <a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a> object.</p>
<p>Timers are summed up across different restarts.</p>
<p>The most useful method in this class is <a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.UniformGridData.average" title="kuibit.grid_data.UniformGridData.average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">average()</span></code></a>, which returns
the average timing information across all the MPI ranks.</p>
<p>Files are read only when needed. At the moment, only XML timers are
supported, but different backends can be added.</p>
<p>Constructor.</p>
<dl class="py property">
<dt class="sig sig-object py" id="kuibit.cactus_timers.TimersDir.average">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">average</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><span class="pre">kuibit.tree.Tree</span></a></em><a class="headerlink" href="#kuibit.cactus_timers.TimersDir.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average timer information across all the processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kuibit.cactus_timers.TimersDir.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kuibit/cactus_timers.html#TimersDir.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kuibit.cactus_timers.TimersDir.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the process numbers for which timer information is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">KeysView</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kuibit.cactus_timers.TimersDir.median">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">median</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><span class="pre">kuibit.tree.Tree</span></a></em><a class="headerlink" href="#kuibit.cactus_timers.TimersDir.median" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the median timer information across all the processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tree_ref.html#kuibit.tree.Tree" title="kuibit.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="cactus_twopunctures_ref.html"
                        title="previous chapter">Reference on kuibit.cactus_twopunctures</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gw_utils_ref.html"
                        title="next chapter">Reference on kuibit.gw_utils</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="gw_utils_ref.html" title="Reference on kuibit.gw_utils"
             >next</a> |</li>
        <li class="right" >
          <a href="cactus_twopunctures_ref.html" title="Reference on kuibit.cactus_twopunctures"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.4.0-dev2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reference on kuibit.cactus_timers</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020-2022, Gabriele Bozzola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>