

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Frequently Asked Questions &#8212; kuibit 1.4.0-dev1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Papers citing this software" href="citations.html" />
    <link rel="prev" title="List of features implemented in kuibit" href="features.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="citations.html" title="Papers citing this software"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="features.html" title="List of features implemented in kuibit"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.4.0-dev1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Frequently Asked Questions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h1>
<section id="what-is-the-userwarning-unused-redundant-file-warning">
<h2>What is the <code class="docutils literal notranslate"><span class="pre">UserWarning:</span> <span class="pre">Unused</span> <span class="pre">(redundant)</span> <span class="pre">file:</span></code> warning?<a class="headerlink" href="#what-is-the-userwarning-unused-redundant-file-warning" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">kuibit</span></code> scans recursively the simulation directory to find what data is
available and organizes it. The warning <code class="docutils literal notranslate"><span class="pre">UserWarning:</span> <span class="pre">Unused</span> <span class="pre">(redundant)</span> <span class="pre">file</span></code>
is emitted when multiple different files claim to contain the same data (for
instance, two grid data files containing the same iteration). A common example
that lead to such scenario is restarting a simulation when the previous
checkpoint could not be produced. More specifically, for instance,
<code class="docutils literal notranslate"><span class="pre">output-0000</span></code> ran successfully and produced a checkpoint, the simulation is
restarted from there and data is saved in <code class="docutils literal notranslate"><span class="pre">output-0001</span></code>. However, the
checkpoint could not be created (for example, because of quota issues or other
crashes). When the simulation is restarted again, a new folder <code class="docutils literal notranslate"><span class="pre">output-0002</span></code>
is produced and the run starts from the checkpoint associated to
<code class="docutils literal notranslate"><span class="pre">output-0000</span></code>. In this case, <code class="docutils literal notranslate"><span class="pre">output-0002</span></code> will initially contain
overlapping iterations as in <code class="docutils literal notranslate"><span class="pre">output-0001</span></code>. If <code class="docutils literal notranslate"><span class="pre">output-0001</span></code> is not removed,
<code class="docutils literal notranslate"><span class="pre">kubit</span></code> will issue a warning.</p>
<p>The default policy in <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> is to use the most recent data.</p>
</section>
<section id="how-do-i-access-grid-data-as-numpy-arrays">
<h2>How do I access grid data as NumPy arrays?<a class="headerlink" href="#how-do-i-access-grid-data-as-numpy-arrays" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">kuibit</span></code> defines its own high-level types to keep complexity under control.
Sometimes, however, one wants to have full control over how the data is stored
and manipulated. Suppose <code class="docutils literal notranslate"><span class="pre">grid_fun</span></code> is the grid function for which you want to
access the data over for the refinement level <code class="docutils literal notranslate"><span class="pre">i</span></code> and component <code class="docutils literal notranslate"><span class="pre">j</span></code> as NumPy
array. <code class="docutils literal notranslate"><span class="pre">grid_fun[i][j]</span></code> is a <a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.UniformGridData" title="kuibit.grid_data.UniformGridData"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformGridData</span></code></a>, a higher-level
object that contains data, coordinates, and additional metadata. For here,
<code class="docutils literal notranslate"><span class="pre">grid_fun[i][j].data</span></code> is the NumPy array with the actual data.</p>
</section>
<section id="some-of-the-attributes-in-simdir-are-slow">
<h2>Some of the attributes in SimDir are slow<a class="headerlink" href="#some-of-the-attributes-in-simdir-are-slow" title="Permalink to this headline">¶</a></h2>
<p>When you instantiate a <a class="reference internal" href="simdir_ref.html#kuibit.simdir.SimDir" title="kuibit.simdir.SimDir"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimDir</span></code></a>, <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> will go through all the
files and organize them. Next, when you ask for specialize your request (e.g.,
you want to work with grid data), <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> will isolate the relevant files and
analyze them more carefully. This can take a long time if you have several
thousands of files. In some cases, <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> has to open each single file to
determine its content (e.g., <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> scans the headers of your files to see
what variables are inside). Opening files has some system overhead that cannot be
reduced.</p>
<p>To solve this problem, you have to reduce the number of files in your directory.
There are two ways to do this:</p>
<ol class="arabic simple">
<li><p>you create a new folder filled with files obtained by concatenating the
corresponding files across different simulations restarts. For example, if
your simulation has 10 restarts, each one with the same file <code class="docutils literal notranslate"><span class="pre">rho.x.asc</span></code>,
you can concatenate all these files in a new <code class="docutils literal notranslate"><span class="pre">rho.x.asc</span></code> in the new folder.
This will decrease the file count by a factor of 10 (the number of restarts).</p></li>
<li><p>you create new folders only containing the data you want to study. Let us
assume that you are only interested in gravitational wave data. You can
create a new folder that follows the same structure of your simulation
directory, and create links to the files you are interested in. Then, when
you use <code class="docutils literal notranslate"><span class="pre">kuibit</span></code> from this second folder, there will be far fewer files to
analyze.</p></li>
</ol>
<p>However, if your data is not changing, the best way to deal with this problem is
with pickles: you can always load and save <code class="docutils literal notranslate"><span class="pre">SimDir</span></code> objects to reduce the
amount of work that needs to be done (<code class="xref py py-meth docutils literal notranslate"><span class="pre">SimDir.save()</span></code>,
<a class="reference internal" href="simdir_ref.html#kuibit.simdir.load_SimDir" title="kuibit.simdir.load_SimDir"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_SimDir()</span></code></a>).</p>
</section>
<section id="refinement-levels-merged-is-too-slow-and-or-requires-too-much-memory">
<h2>refinement_levels_merged() is too slow and/or requires too much memory<a class="headerlink" href="#refinement-levels-merged-is-too-slow-and-or-requires-too-much-memory" title="Permalink to this headline">¶</a></h2>
<p>When working with grid data, it is tempting to deal with
<a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData" title="kuibit.grid_data.HierarchicalGridData"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalGridData</span></code></a> using <a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData.refinement_levels_merged" title="kuibit.grid_data.HierarchicalGridData.refinement_levels_merged"><code class="xref py py-meth docutils literal notranslate"><span class="pre">refinement_levels_merged()</span></code></a> so
that you do not have to deal with all the complexity of the various refinement
levels. However, what <a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData.refinement_levels_merged" title="kuibit.grid_data.HierarchicalGridData.refinement_levels_merged"><code class="xref py py-meth docutils literal notranslate"><span class="pre">refinement_levels_merged()</span></code></a> does is to reduce
everything to the highest resolution. If you have several refinement levels in a
large grid, this would require hundreds of terabytes!</p>
<p><a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData.refinement_levels_merged" title="kuibit.grid_data.HierarchicalGridData.refinement_levels_merged"><code class="xref py py-meth docutils literal notranslate"><span class="pre">refinement_levels_merged()</span></code></a> is provided as a convenience function for
small simulations. For larger simulations, you have to work directly with
<a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData" title="kuibit.grid_data.HierarchicalGridData"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalGridData</span></code></a> (which fully support all the various
mathematical operations and other various methods), until you want to plot the
result. When are ready to plot, you should use the method
<a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData.to_UniformGridData" title="kuibit.grid_data.HierarchicalGridData.to_UniformGridData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_UniformGridData()</span></code></a> instead of <a class="reference internal" href="grid_data_ref.html#kuibit.grid_data.HierarchicalGridData.refinement_levels_merged" title="kuibit.grid_data.HierarchicalGridData.refinement_levels_merged"><code class="xref py py-meth docutils literal notranslate"><span class="pre">refinement_levels_merged()</span></code></a>.
With this function you can control the region where you want to focus and the
resolution that you want to work with. In this way, you can reduce the number of
computations needed and make the problem tractable.</p>
</section>
<section id="i-want-to-pre-process-psi4-before-computing-the-strain">
<h2>I want to pre-process Psi4 before computing the strain<a class="headerlink" href="#i-want-to-pre-process-psi4-before-computing-the-strain" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a> contains methods to compute quantities
from <code class="docutils literal notranslate"><span class="pre">Psi4</span></code>, but sometimes is desirable to perform some operations on <code class="docutils literal notranslate"><span class="pre">Psi4</span></code>
first. The easiest way to do so is to create a new
<a class="reference internal" href="cactus_waves_ref.html#kuibit.cactus_waves.GravitationalWavesOneDet" title="kuibit.cactus_waves.GravitationalWavesOneDet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code></a> with the new data. For instance, to
smooth <code class="docutils literal notranslate"><span class="pre">Psi4</span></code> (with the Savitzky-Golay filter):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kuibit.cactus_waves</span> <span class="kn">import</span> <span class="n">GravitationalWavesOneDet</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">mult_l</span><span class="p">,</span> <span class="n">mult_m</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">wav</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">mult_l</span><span class="p">,</span> <span class="n">mult_m</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">savgol_smoothed</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)])</span>

<span class="n">new_wav</span> <span class="o">=</span> <span class="n">GravitationalWavesOneDet</span><span class="p">(</span><span class="n">wav</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">wav</span></code> is the old <code class="docutils literal notranslate"><span class="pre">GravitationalWavesOneDet</span></code>, <code class="docutils literal notranslate"><span class="pre">new_wav</span></code> the new one.</p>
<p>Another common operation is cropping the data (e.g., to remove junk radiation).
You can use the same approach, or use directly the <cite>~.:py:meth:crop</cite> or
<cite>~.:py:meth:cropped</cite> methods.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Frequently Asked Questions</a><ul>
<li><a class="reference internal" href="#what-is-the-userwarning-unused-redundant-file-warning">What is the <code class="docutils literal notranslate"><span class="pre">UserWarning:</span> <span class="pre">Unused</span> <span class="pre">(redundant)</span> <span class="pre">file:</span></code> warning?</a></li>
<li><a class="reference internal" href="#how-do-i-access-grid-data-as-numpy-arrays">How do I access grid data as NumPy arrays?</a></li>
<li><a class="reference internal" href="#some-of-the-attributes-in-simdir-are-slow">Some of the attributes in SimDir are slow</a></li>
<li><a class="reference internal" href="#refinement-levels-merged-is-too-slow-and-or-requires-too-much-memory">refinement_levels_merged() is too slow and/or requires too much memory</a></li>
<li><a class="reference internal" href="#i-want-to-pre-process-psi4-before-computing-the-strain">I want to pre-process Psi4 before computing the strain</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="features.html"
                        title="previous chapter">List of features implemented in kuibit</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="citations.html"
                        title="next chapter">Papers citing this software</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="citations.html" title="Papers citing this software"
             >next</a> |</li>
        <li class="right" >
          <a href="features.html" title="List of features implemented in kuibit"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">kuibit 1.4.0-dev1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Frequently Asked Questions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020-2022, Gabriele Bozzola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>