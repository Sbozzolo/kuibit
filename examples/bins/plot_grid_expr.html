

<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>plot_grid_expr.py &#8212; kuibit 1.4.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="plot_gw_energy.py" href="plot_gw_energy.html" />
    <link rel="prev" title="plot_grid_var.py" href="plot_grid_var.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_gw_energy.html" title="plot_gw_energy.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_grid_var.html" title="plot_grid_var.py"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kuibit 1.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">plot_grid_expr.py</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="plot-grid-expr-py">
<h1>plot_grid_expr.py<a class="headerlink" href="#plot-grid-expr-py" title="Permalink to this heading">Â¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">plot_grid_expr</span></code> plots any mathematical expression involving 2D grid function
as output by Carpet. It takes as input the expriable, and the region of space
where to plot it. The symbols that can be used are <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>,
<code class="docutils literal notranslate"><span class="pre">%</span></code>, <code class="docutils literal notranslate"><span class="pre">^</span></code>, <code class="docutils literal notranslate"><span class="pre">PI</span></code>, <code class="docutils literal notranslate"><span class="pre">E</span></code>, <code class="docutils literal notranslate"><span class="pre">sin(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">cos(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">tan(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">asin(x)</span></code>,
<code class="docutils literal notranslate"><span class="pre">acos(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">atan(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">log(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">log10(x)</span></code>, <code class="docutils literal notranslate"><span class="pre">abs(x)</span></code>, and <code class="docutils literal notranslate"><span class="pre">exp(x)</span></code>.
For example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>plot_grid_expr.py<span class="w"> </span><span class="s2">&quot;2 * P / rho_b^(3/2) &quot;</span>
</pre></div>
</div>
<p>This is defined by giving the resolution, the lowermost leftmost coordinate
(<code class="docutils literal notranslate"><span class="pre">--x0</span></code>), and the topmost rightmost one (<code class="docutils literal notranslate"><span class="pre">--x1</span></code>). Optionally, it is possible
to take the logarithm base 10 and/or the absolute value. It is also possible to
perform interpolation in two different ways: one at the level of the data
(slower, but more accurate), and the other at the level of the image using the
interpolations available in matplotlib.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># PYTHON_ARGCOMPLETE_OK</span>

<span class="c1"># Copyright (C) 2021-2023 Gabriele Bozzola</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify it under</span>
<span class="c1"># the terms of the GNU General Public License as published by the Free Software</span>
<span class="c1"># Foundation; either version 3 of the License, or (at your option) any later</span>
<span class="c1"># version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="c1"># ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<span class="c1"># FOR A PARTICULAR PURPOSE. See the GNU General Public License for more</span>
<span class="c1"># details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License along with</span>
<span class="c1"># this program; if not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">py_expression_eval</span> <span class="kn">import</span> <span class="n">Parser</span> <span class="k">as</span> <span class="n">math_parser</span>

<span class="kn">from</span> <span class="nn">kuibit</span> <span class="kn">import</span> <span class="n">argparse_helper</span> <span class="k">as</span> <span class="n">kah</span>
<span class="kn">from</span> <span class="nn">kuibit</span> <span class="kn">import</span> <span class="n">masks</span> <span class="k">as</span> <span class="n">km</span>
<span class="kn">from</span> <span class="nn">kuibit.simdir</span> <span class="kn">import</span> <span class="n">SimDir</span>
<span class="kn">from</span> <span class="nn">kuibit.visualize_matplotlib</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">add_text_to_corner</span><span class="p">,</span>
    <span class="n">get_figname</span><span class="p">,</span>
    <span class="n">plot_color</span><span class="p">,</span>
    <span class="n">plot_components_boundaries</span><span class="p">,</span>
    <span class="n">plot_horizon_on_plane_at_iteration</span><span class="p">,</span>
    <span class="n">save_from_dir_filename_ext</span><span class="p">,</span>
    <span class="n">set_axis_limits</span><span class="p">,</span>
    <span class="n">setup_matplotlib</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># NOTE: This example is also implemented in a movie file with the same name. If</span>
<span class="c1">#       you update this file, you probably want to update the movie file as</span>
<span class="c1">#       well.</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="si">{</span><span class="n">kah</span><span class="o">.</span><span class="n">get_program_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> plot a given expression involving grid functions.</span>
<span class="s2">Use the name of the grid functions, and algebraic expressions. For example,</span>
<span class="s2">sin(rho_b) * log10(P).</span>

<span class="s2">By default, no interpolation is performed so the image may look pixelated.</span>
<span class="s2">There are two available modes of interpolation. The first is activated</span>
<span class="s2">with --multilinear-interpolation. With this, the data from the simulation</span>
<span class="s2">is interpolated with a multilinear interpolation onto the plotting grid.</span>
<span class="s2">This is accurate and uses all the information available, but it is slow.</span>
<span class="s2">A second way to perform interpolation is passing a --interpolation-method</span>
<span class="s2">argument (e.g., bicubic). With this, the plotting data is interpolated.</span>
<span class="s2">This is much faster but it is not as accurate.&quot;&quot;&quot;</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">kah</span><span class="o">.</span><span class="n">init_argparse</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="n">kah</span><span class="o">.</span><span class="n">add_grid_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">kah</span><span class="o">.</span><span class="n">add_figure_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">kah</span><span class="o">.</span><span class="n">add_horizon_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">kah</span><span class="o">.</span><span class="n">add_grid_structure_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Expression to plot.&quot;</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--iteration&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Iteration to plot. If -1, the latest.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--multilinear-interpolate&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether to interpolate to smooth data with multilinear&quot;</span>
        <span class="s2">&quot; interpolation before plotting.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--interpolation-method&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Interpolation method for the plot. See docs of np.imshow.&quot;</span>
        <span class="s2">&quot; (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--colorbar&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether to draw the color bar.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
        <span class="s2">&quot;--vmin&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Minimum value of the variable. &quot;</span>
            <span class="s2">&quot;If logscale is True, this has to be the log.&quot;</span>
        <span class="p">),</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
        <span class="s2">&quot;--vmax&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Maximum value of the variable. &quot;</span>
            <span class="s2">&quot;If logscale is True, this has to be the log.&quot;</span>
        <span class="p">),</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">kah</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">setup_matplotlib</span><span class="p">(</span><span class="n">rc_par_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">mpl_rc_file</span><span class="p">)</span>

    <span class="c1"># Parse arguments</span>

    <span class="n">iteration</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">iteration</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">corner</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">resolution</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">]</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="n">expr</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">figname</span> <span class="o">=</span> <span class="n">get_figname</span><span class="p">(</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">expr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expression </span><span class="si">{</span><span class="n">expr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">SimDir</span><span class="p">(</span>
        <span class="n">args</span><span class="o">.</span><span class="n">datadir</span><span class="p">,</span>
        <span class="n">ignore_symlinks</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ignore_symlinks</span><span class="p">,</span>
        <span class="n">pickle_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">pickle_file</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Prepared SimDir&quot;</span><span class="p">)</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">gridfunctions</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">plane</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables available </span><span class="si">{</span><span class="n">reader</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">exp_parser</span> <span class="o">=</span> <span class="n">math_parser</span><span class="p">()</span>

        <span class="c1"># We need to make sure that the correct methods are being used. That is,</span>
        <span class="c1"># not the ones in python.math.</span>
        <span class="n">exp_parser</span><span class="o">.</span><span class="n">ops1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;exp&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span>
                <span class="s2">&quot;sin&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span>
                <span class="s2">&quot;cos&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span>
                <span class="s2">&quot;tan&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">tan</span><span class="p">,</span>
                <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">log</span><span class="p">,</span>
                <span class="s2">&quot;log10&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">log10</span><span class="p">,</span>
                <span class="s2">&quot;asin&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">arcsin</span><span class="p">,</span>
                <span class="s2">&quot;acos&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">arccos</span><span class="p">,</span>
                <span class="s2">&quot;atan&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">arctan</span><span class="p">,</span>
                <span class="s2">&quot;sqrt&quot;</span><span class="p">:</span> <span class="n">km</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span>
                <span class="s2">&quot;abs&quot;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">variable_names</span> <span class="o">=</span> <span class="n">exp_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span>

        <span class="c1"># vars_ is a dict that contains NumPy arrays for all the various</span>
        <span class="c1"># variables involved. We use NumPy arrays because py_expression_eval</span>
        <span class="c1"># doesn&#39;t support complex types. Hence, we need to resample more often</span>
        <span class="c1"># than we could have done.</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">variable_names</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">reader</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">iteration</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">available_iterations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">var_name</span><span class="p">:</span> <span class="n">var</span><span class="p">[</span><span class="n">iteration</span><span class="p">]})</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read variable </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">time</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">time_at_iteration</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (time = </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Plotting on grid with x0 = </span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s2">, x1 = </span><span class="si">{</span><span class="n">x1</span><span class="si">}</span><span class="s2">, shape = </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">exp_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resampling and plotting&quot;</span><span class="p">)</span>
        <span class="n">plot_color</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
            <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
            <span class="n">resample</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">multilinear_interpolate</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">plane</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">plane</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">colorbar</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">colorbar</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">interpolation_method</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">add_text_to_corner</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$t = </span><span class="si">{</span><span class="n">time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">ah_show</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ah</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">horizons</span><span class="o">.</span><span class="n">available_apparent_horizons</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting apparent horizon </span><span class="si">{</span><span class="n">ah</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">plot_horizon_on_plane_at_iteration</span><span class="p">(</span>
                    <span class="n">sim</span><span class="o">.</span><span class="n">horizons</span><span class="o">.</span><span class="n">get_apparent_horizon</span><span class="p">(</span><span class="n">ah</span><span class="p">),</span>
                    <span class="n">iteration</span><span class="p">,</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">plane</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ah_color</span><span class="p">,</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ah_edge_color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ah_alpha</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">rl_show</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plotting grid structure&quot;</span><span class="p">)</span>
            <span class="n">plot_components_boundaries</span><span class="p">(</span>
                <span class="n">data</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">rl_edge_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">rl_alpha</span>
            <span class="p">)</span>

        <span class="n">set_axis_limits</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmax</span><span class="o">=</span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plotted&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Saving&quot;</span><span class="p">)</span>
        <span class="n">save_from_dir_filename_ext</span><span class="p">(</span>
            <span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
            <span class="n">figname</span><span class="p">,</span>
            <span class="n">args</span><span class="o">.</span><span class="n">fig_extension</span><span class="p">,</span>
            <span class="n">tikz_clean_figure</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">tikz_clean_figure</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;DONE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_grid_var.html"
                          title="previous chapter">plot_grid_var.py</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_gw_energy.html"
                          title="next chapter">plot_gw_energy.py</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div role="note" aria-label="version link">
  <h3>Versions</h3>
    <ul class="this-page-menu">
      <li><a href="../../dev/examples/bins/plot_grid_expr.html" rel="nofollow"> Development </a></li>
      <li><a href="#" rel="nofollow"> Master </a></li>

      
      <li><a href="../../1.3.6/examples/bins/plot_grid_expr.html" rel="nofollow"> 1.3.6 </a></li>
      
      <li><a href="../../1.4.0/examples/bins/plot_grid_expr.html" rel="nofollow"> 1.4.0 </a></li>
      
      <li><a href="../../1.4.1/examples/bins/plot_grid_expr.html" rel="nofollow"> 1.4.1 </a></li>
      

    </ul>
 </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_gw_energy.html" title="plot_gw_energy.py"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_grid_var.html" title="plot_grid_var.py"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">kuibit 1.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">plot_grid_expr.py</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020-2023, Gabriele Bozzola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    </div>
  </body>
</html>